Execute (setting up testing environment):
  chdir test/files
  Log 'running tests using cwd: ' . getcwd()

Before:
  Treevial

================================================================================

Execute (buffer has name "treevial"):
  Assert bufexists('treevial')

Execute (buffer has filetype "treevial"):
  AssertEqual 'treevial', &ft

Execute (buffer is readonly):
  AssertEqual 1, &ro

================================================================================

Expect (buffer lists contents of test/files/):
  files/
    folded-exe/example.sh
    folded-sym/example.ln
    folded-sym-exe/example.sh
    folded-sym-long/example.ln
  + nested/directory/
    example.ln
    example.sh
    example.txt

================================================================================

Do (expand test/files/nested/directory/ using <enter>):
  5j\<Cr>

Expect (buffer shows contents nested in test/files/nested/directory/):
  files/
    folded-exe/example.sh
    folded-sym/example.ln
    folded-sym-exe/example.sh
    folded-sym-long/example.ln
  - nested/directory/
      a.txt
      b.txt
    example.ln
    example.sh
    example.txt

================================================================================

Execute (remove nested/directory/c.txt if it exists):
  if filereadable('nested/directory/c.txt')
    call delete('nested/directory/c.txt') | Treevial
  endif

Do (add nested/directory/c.txt):
  c/nested/directory/c.txt\<Cr>

Execute (nested/directory/c.txt exists):
  Assert filereadable('nested/directory/c.txt')

  if filereadable('nested/directory/c.txt')
    call delete('nested/directory/c.txt') | Treevial
  endif

================================================================================

Execute (un-rename nested/directory/1.txt if it exists):
  if filereadable('nested/directory/1.txt')
    call rename('nested/directory/1.txt', 'nested/directory/a.txt') | Treevial
  endif

Do (rename nested/directory/b.txt to nested/directory/d.txt):
  gg6jm\<Left>\<Left>\<Left>\<Left>\<Bs>1\<Cr>

Execute (nested/directory/1.txt exists):
  Assert filereadable('nested/directory/1.txt')
  Assert !filereadable('nested/directory/a.txt')

  if filereadable('nested/directory/1.txt')
    call rename('nested/directory/1.txt', 'nested/directory/a.txt') | Treevial
  endif
